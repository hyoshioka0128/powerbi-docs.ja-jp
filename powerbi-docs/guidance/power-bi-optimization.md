---
title: Power BI の最適化ガイド
description: Power BI の最適化ガイドです。
author: peter-myers
ms.reviewer: asaxton
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 02/16/2020
ms.author: v-pemyer
ms.openlocfilehash: 0f29b70a42375be945d206672116219b7d5a3b48
ms.sourcegitcommit: 032a77f2367ca937f45e7e751997d7b7d0e89ee2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/26/2020
ms.locfileid: "77609997"
---
# <a name="optimization-guide-for-power-bi"></a>Power BI の最適化ガイド

この記事では、開発者と管理者が、最適化された Power BI ソリューションを作成および維持できるようにするためのガイダンスを提供します。 ソリューションは、さまざまなアーキテクチャ レイヤーで最適化することができます。 次のようなレイヤーがあります。

- データ ソース
- データ モデル
- 視覚化 (ダッシュボード、Power BI レポート、Power BI のページ分割されたレポートなど)
- 環境 (容量、データ ゲートウェイ、ネットワークなど)

## <a name="optimizing-the-data-model"></a>データ モデルの最適化

データ モデルでは、視覚化エクスペリエンス全体がサポートされています。 データ モデルは、外部でホストされるか内部でホストされるかのいずれかであり、Power BI では "_データセット_" と呼ばれます。 選択肢を理解し、ご自分のソリューションに適したデータセットの種類を選択することが重要です。 次の 3 つのデータセット モードがあります:インポート、DirectQuery、複合。 詳細については、「[Power BI サービスのデータセット](../service-datasets-understand.md)」と「[Power BI サービスのデータセット モード](../service-dataset-modes-understand.md)」をご覧ください。

特定のデータセット モードのガイダンスについては、以下を参照してください。

- [インポート モデリングのデータ削減手法](import-modeling-data-reduction.md)
- [Power BI Desktop の DirectQuery モデルのガイダンス](directquery-model-guidance.md)
- [Power BI Desktop の複合モデルのガイダンス](composite-model-guidance.md)

## <a name="optimizing-visualizations"></a>視覚化の最適化

Power BI の視覚化には、ダッシュボード、Power BI レポート、または Power BI のページ分割されたレポートがあります。 それぞれアーキテクチャが異なるため、それぞれに対して個別のガイダンスを示します。 

### <a name="dashboards"></a>ダッシュボード

Power BI では、ダッシュボードのタイルのキャッシュが保持されることを理解しておくことが重要です。ただし、ライブ レポート タイルとストリーミング タイルは除きます。 詳細については、[Power BI でのデータ更新 (タイルの更新)](../refresh-data.md#tile-refresh) に関する記事をご覧ください。 お使いのデータセットで動的な[行レベルのセキュリティ (RLS)](../service-admin-rls.md) が適用される場合は、タイルがユーザー単位でキャッシュされるため、パフォーマンスへの影響があることを理解しておく必要があります。

ライブ レポート タイルをダッシュボードにピン留めしても、それらがクエリ キャッシュから提供されることはありません。 代わりに、それらはレポートのように動作し、バックエンド コアに対してすぐにクエリを実行します。

名前からわかるように、キャッシュからデータを取得することで、データ ソースに依存するよりも優れた、より一貫性のあるパフォーマンスが実現できます。 この機能を活用するための 1 つの方法は、ダッシュボードをユーザーのための最初のランディング ページにすることです。 よく使用され、頻繁に要求されるビジュアルをダッシュボードにピン留めします。 こうすることで、ダッシュボードが貴重な "防御の最前線" となり、容量の負荷を抑え、一貫したパフォーマンスを実現することができます。 ユーザーは引き続き、レポートをクリックして詳細情報を分析することができます。

DirectQuery とライブ接続のデータセットの場合、キャッシュはデータ ソースにクエリを実行することで定期的に更新されます。 既定では、これは 1 時間ごとに実行されますが、データセットの設定で異なる頻度を構成することもできます。 キャッシュの各更新では、キャッシュを更新するために基になるデータ ソースに対してクエリが送信されます。 生成されるクエリの数は、データ ソースに依存するダッシュボードにピン留めされたビジュアルの数によって異なります。 行レベルのセキュリティが有効になっている場合は、異なるセキュリティ コンテキストごとにクエリが生成されることに注意してください。 たとえば、ユーザーを分類する 2 つの異なるロールがあり、それらには 2 つの異なるデータのビューがあるとします。 クエリ キャッシュの更新中に、Power BI によって 2 つのセットのクエリが生成されます。

### <a name="power-bi-reports"></a>Power BI レポート

Power BI レポートのデザインを最適化するには、いくつかの推奨事項があります。

> [!NOTE]
> レポートが DirectQuery データセットに基づいている場合、さらなるレポート デザインの最適化については、[Power BI Desktop の DirectQuery モデルのガイダンス (レポートのデザインを最適化する)](directquery-model-guidance.md#optimize-report-designs) に関する記事をご覧ください。

#### <a name="apply-the-most-restrictive-filters"></a>最も制限の厳しいフィルターを適用する

ビジュアルで表示しなければならないデータが増えると、ビジュアルの読み込みがそれだけ遅くなります。 これは当然の原則であるように思われますが、忘れがちなことです。 たとえば、大規模なデータセットがあるとします。 そのデータセットの上に、テーブルを使用してレポートを作成します。 エンド ユーザーは、ページ上のスライサーを使用して目的の行に到達します。通常、関心があるのは数十の行だけです。

よくある間違いは、テーブルの既定のビューをフィルター処理しないことです。つまり、1 億を超えるすべての行が表示されます。 これらの行のデータはメモリに読み込まれ、更新のたびに圧縮解除されます。 この処理により、メモリの需要が大量に発生します。 解決策: "上位 N" のフィルターを使用して、テーブルに表示される項目の最大数を減らします。 項目の最大数は、ユーザーが必要とする数より大きくする (10,000 など) ことができます。 その結果、エンドユーザー エクスペリエンスが変わることはありませんが、メモリ使用量が大幅に低下します。 そして、最も重要なこととして、パフォーマンスが向上します。

レポート内のすべてのビジュアルに対して、上記と似たようなデザインのアプローチを使用することをお勧めします。 このビジュアルのデータはすべて必要かどうか、 エンドユーザー エクスペリエンスへの影響を最小限に抑えながら、ビジュアルに表示されるデータの量をフィルター処理する方法はありますか。 テーブルには特にコストがかかる場合があることを忘れないでください。

#### <a name="limit-visuals-on-report-pages"></a>レポート ページのビジュアルを制限する

上記の原則は、レポート ページに追加するビジュアルの数にも同様に当てはまります。 特定のレポート ページ上のビジュアルの数を、必要な分だけに制限することを強くお勧めします。 [ドリルスルー ページ](report-drillthrough.md)と[レポート ページのヒント](report-page-tooltips.md)は、ページにさらに多くのビジュアルを詰め込むことなく、追加の詳細情報を表示するための優れた方法です。

#### <a name="evaluate-custom-visual-performance"></a>カスタム ビジュアルのパフォーマンスを評価する

高パフォーマンスを得るため、必ず各カスタム ビジュアルの性能を試します。 適切に最適化されていないカスタム ビジュアルは、レポート全体のパフォーマンスに悪影響を及ぼす場合があります。

### <a name="power-bi-paginated-reports"></a>Power BI のページ分割されたレポート

Power BI のページ分割されたレポートのデザインを最適化するには、レポートのデータ取得に対してベスト プラクティスのデザインを適用します。 詳細については、「[ページ分割されたレポートでのデータ取得のガイダンス](report-paginated-data-retrieval.md)」をご覧ください。

また、ご使用の容量で、[ページ分割されたレポート ワークロード](../service-admin-premium-workloads.md#paginated-reports)に十分なメモリが割り当てられていることを確認してください。

## <a name="optimizing-the-environment"></a>環境の最適化

容量設定の構成、データ ゲートウェイのサイズ変更、およびネットワーク待機時間の短縮により、Power BI 環境を最適化することができます。

### <a name="capacity-settings"></a>容量の設定

専用容量 (Power BI Premium (P SKU) または Power BI Embedded (A SKU、A4-A6) で利用可能) を使用する場合は、容量の設定を管理できます。 詳細については、「[Premium 容量を管理する](../service-premium-capacity-manage.md)」を参照してください。 容量を最適化する方法のガイダンスについては、「[Premium 容量を最適化する](../service-premium-capacity-optimize.md)」をご覧ください。

### <a name="gateway-sizing"></a>ゲートウェイのサイズ設定

インターネット経由で直接アクセスできないデータに Power BI がアクセスする必要がある場合は、常にゲートウェイが必要です。 オンプレミスのサーバー、または VM でホストされるサービスとしてのインフラストラクチャ (IaaS) に、[オンプレミス データ ゲートウェイ](../service-gateway-onprem.md)をインストールすることができます。

ゲートウェイのワークロードとサイズ設定の推奨事項について理解するには、「[オンプレミス データ ゲートウェイのサイズ設定](gateway-onprem-sizing.md)」をご覧ください。

### <a name="network-latency"></a>ネットワーク待機時間

ネットワーク待機時間は、要求が Power BI サービスに到達するまでに要する時間と、応答の配信に要する時間が増えることで、レポートのパフォーマンスに影響を及ぼす可能性があります。 Power BI のテナントは、特定のリージョンに割り当てられています。

> [!TIP]
> ご自身のテナントが配置されている場所を特定するには、「[Power BI テナントの場所](../service-admin-where-is-my-tenant-located.md)」をご覧ください。

テナントのユーザーが Power BI サービスにアクセスすると、要求は常にこのリージョンにルーティングされます。 要求が Power BI サービスに到達すると、サービスからさらに要求が送信されることがあります (たとえば、基になるデータ ソースやデータ ゲートウェイに対して)。これもネットワーク待機時間の影響を受けます。

[Azure Speed Test](https://azurespeedtest.azurewebsites.net/) などのツールによって、クライアントと Azure リージョン間のネットワーク待機時間の表示が提供されます。 一般に、ネットワーク待機時間の影響を最小限に抑えるには、データ ソース、ゲートウェイ、および Power BI クラスターをできるだけ近くに配置するようにします。 可能であれば、それらを同じリージョン内に配置します。 ネットワーク待機時間が問題になっている場合は、ゲートウェイとデータ ソースをクラウドでホストされる仮想マシン内に配置することで、Power BI クラスターにより近い位置に配置してみてください。

## <a name="monitoring-performance"></a>パフォーマンス監視

パフォーマンスを監視して、ボトルネックを特定することができます。 低速なクエリ (またはレポート ビジュアル) は、継続的な最適化の中心点にする必要があります。 監視は、デザイン時に Power BI Desktop で、または Power BI Premium 容量の運用ワークロードで行うことができます。 詳細については、[Power BI でのレポートのパフォーマンスの監視](monitor-report-performance.md)に関する記事をご覧ください。

## <a name="next-steps"></a>次の手順

この記事に関する詳細については、次のリソースを参照してください。

- [Power BI ガイダンス](index.yml)
- [レポートのパフォーマンスの監視](monitor-report-performance.md)
- ホワイト ペーパー:[Power BI のエンタープライズ展開の計画](https://go.microsoft.com/fwlink/?linkid=2057861)
- わからないことがある場合は、 [Power BI コミュニティで質問してみてください](https://community.powerbi.com/)。
- Power BI チームへのご提案は、 [Power BI を改善するためのアイデアをお寄せください](https://ideas.powerbi.com/)
