---
title: Power BI Premium Gen2 (プレビュー) について
description: Power BI Premium Gen2 の動作のしくみを、その主な機能に関する概念と共に理解します。
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-premium
ms.topic: conceptual
ms.date: 03/18/2021
LocalizationGroup: Premium
ms.openlocfilehash: d17fc6055296568b4c9c434bdd98c0941c55f4f7
ms.sourcegitcommit: 7727a56e54e2f50098106c6d7454b725ed6baa19
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/20/2021
ms.locfileid: "104726163"
---
# <a name="understanding-power-bi-premium-gen2-preview"></a>Power BI Premium Gen2 (プレビュー) について

**Power BI Premium Generation 2** (便宜上、**Premium Gen2** と呼ばれます) は、機能強化され、アーキテクチャ的に再設計された世代の Power BI Premium です。 Premium Gen2 は現在プレビュー段階であり、Premium サブスクライバーがプレビュー期間中に使用できます。 元のバージョンの Premium を使用することも、Premium Gen2 を使用するように切り替えることもできます。 Premium 容量の場合は、どちらか一方のみを使用できます。

この記事では、Power BI Premium Gen2 の重要な概念とその影響について、Power BI Premium の元のバージョンとはどのように異なるかを含めて説明します。 

![Premium Generation 2 の有効化](media/service-premium-what-is/enable-premium-gen2.gif#lightbox) 

## <a name="premium-gen2-architecture-improvements"></a>Premium Gen2 のアーキテクチャの機能強化

Premium Gen2 でのアーキテクチャの変更 (特に、CPU リソースの割り当ておよび使用方法に関する変更) により、オファリングにおける汎用性やライセンス モデルにおける柔軟性の向上が可能になります。 たとえば、この新しいアーキテクチャにより、Premium をユーザーごとに [Premium Per User](service-premium-per-user-faq.md) として提供する (現在はプレビュー段階) ことが可能になります。 このアーキテクチャはまた、顧客により高いパフォーマンスを提供すると共に、その Power BI の経費に対するガバナンスや制御も向上させることができます。

Premium Gen2 のアーキテクチャでの最も重要な更新は、容量のバックエンド仮想コア (CPU、多くの場合は仮想コアと呼ばれます) の実装方法です。

* Power BI Premium の元のバージョンでは、バックエンド仮想コアは、顧客のライセンス SKU に応じて仮想コアの数やオンボード メモリの量が異なる、クラウド内の専用の物理コンピューティング ノードでした。 顧客管理者は、*Premium Metrics アプリ* を使用して、これらのノードのビジー状態を追跡する必要がありました。 これらの管理者は、このアプリやその他のツールを使用して、ユーザーのコンピューティング ニーズを満たすために必要な容量を決定する必要がありました。

* 各管理者は、ワークロード (データセット、データフロー、ページ分割されたレポート、AI) の間のリソース競合や、その他のパフォーマンスへの大きな影響を回避するために容量を調整したり構成したりして、容量パフォーマンスをチューニングされた状態または許容される状態に維持することができました。

Premium Gen2 では、バックエンド仮想コアは、クラウド内の物理ノードのリージョン クラスターに実装されます。これは、その Power BI リージョン内の Premium 容量を使用しているすべてのテナントによって共有されます。 このリージョン クラスターはさらに、各グループが異なる Power BI ワークロード (データセット、データフロー、またはページ分割されたレポート) を処理する特殊なノード グループに分割されます。 これらの特殊なノード グループは、同じノードで実行されている基本的に異なるワークロード間のリソース競合を回避するために役立ちます。

Premium Gen2 容量に割り当てられているワークスペースのコンテンツは、組織の容量のストレージ層に格納されます。これは、Premium の元のバージョンと同様に、容量固有の Azure Storage BLOB コンテナー上に実装されます。 このアプローチにより、BYOK などの機能をデータに使用できるようになります。

コンテンツの表示または更新が必要になると、そのコンテンツがストレージ層から読み取られ、コンピューティングのために Premium Gen2 バックエンド ノードに配置されます。 Power BI では、コンピューティング ノードの適切なグループ内の最適なノードが選択されることを保証する配置メカニズムを使用します。 このメカニズムでは通常、最も多いリソースへのアクセスを取得することによって表示または更新操作を最適に実行できるように、新しいコンテンツを、そのコンテンツが読み込まれた時点で使用可能なメモリが最も多いノードに配置します。 

容量によって追加のコンテンツがレンダリングおよび更新されると、それぞれに操作を高速かつ正常に完了するための十分なリソースを備えた追加のコンピューティング ノードが使用されます。つまり、容量によって複数のコンピューティング ノードが使用される可能性があり、さらに場合によっては、Power BI サービスではノードまたはリソースにまたがる内部の負荷分散が実行されるため、コンテンツがノード間で移動される可能性さえあります。 このような負荷分散が実行される場合、Power BI では、コンテンツの移動がエンドユーザー エクスペリエンスに影響を与えないようにします。

コンテンツ (データセット、データフロー、ページ分割されたレポート) のバックエンド処理を共有バックエンド ノードにわたって分散することからは、次のようないくつかの肯定的な結果が得られます。

1. 共有ノードは、少なくとも元の Premium P3 ノードと同じ大きさです。つまり、どの操作を実行するにもより多くの仮想コアが存在するため、元の Premium P1 と比較した場合、パフォーマンスが最大 16 倍に向上する可能性があります。
2. ユーザーの処理がどのノードで実行されている場合でも、この配置メカニズムでは、該当する容量のメモリ制約内で、メモリがユーザーの操作を完了できる状態に維持されることが保証されます。 (メモリ制約の詳細については、このドキュメントの制限事項のセクションを参照)。
3. 各 "*表示*" および "*更新*" 操作では、異なるコンピューティング ノード上の (独自のメモリを備えた) 独自の一連の物理仮想コアを使用するため、容量における内部でのノイズの多い近隣の問題は発生しません。
4. ワークロード間のリソース競合は、共有ノードを特殊なワークロード グループに分離することによって防止されます。
5. さまざまな容量 SKU に対する制限は、Premium の元のバージョンのときのような物理的な制約に基づいているわけではなく、Power BI Premium サービスで適用される、予測される明確な一連のルールに基づいています。
    * 合計容量の CPU スループットは、ユーザーが購入した容量に含まれている仮想コアで可能なスループット以下になります。
    * 表示および更新操作に必要なメモリ消費量は、ユーザーが購入した容量のメモリ制限内に維持されます。
6. この新しいアーキテクチャのため、顧客管理者はその容量を監視してリソースの制限に近づいている兆候がないかどうかを確認する必要はなく、代わりに、このような制限が満たされたときには明確な兆候が提供されます。 これにより、最適な容量パフォーマンスを維持するために容量管理者に必要になる労力やオーバーヘッドが大幅に削減されます。

## <a name="premium-gen2-capacity-load-evaluation"></a>Premium Gen2 の容量負荷の評価

CPU スループットの制限を適用するために、Power BI では、Premium Gen2 容量のスループットを継続的に評価します。 Power BI では、スループットを 30 秒ごとに評価します。 ここでは、操作の完了を許可し、共有プールの物理ノードの CPU 上での実行時間を収集した後、その容量でのすべての操作について、それらを 30 秒の間隔に集計し、その結果をユーザーが購入した容量でサポートできる数値と比較します。 

1 つの例を見てみましょう。4 つのバックエンド仮想コアを備えた P1 は、(4 x 30 秒 = 120) 秒の仮想コアの実行時間 ("*CPU 時間*" とも呼ばれます) をサポートできます。 

この集計は複雑です。 ここでは、次の要点で説明されているように、さまざまなワークロードや、さまざまな操作の種類に対して特殊なアルゴリズムを使用します。

* **実行速度の遅い操作** (データセットやデータフローの更新など) は、通常はバックグラウンドで実行され、ユーザーが積極的に監視したり視覚的に確認したりしないため、"*バックグラウンド操作*" と見なされます。 バックグラウンド操作は非常に長く、長いプロセス中に完了するために大量の CPU パワーを必要とします。 Power BI では、バックグラウンド操作の CPU コストを 24 時間にわたって分散させ、同時に実行される更新の数が多すぎるために容量が最大のリソース使用率に達してしまうことがないようにします。 これにより、Power BI Premium Gen2 サブスクライバーは、購入した容量 SKU によって許可される数のバックグラウンド操作を実行することができ、元の Premium 世代のような制限を受けることはありません。

* **高速な操作** (クエリやレポートの読み込みなど) は、"*対話型の操作*" と見なされます。 これらの操作を完了するために必要な CPU 時間は、その操作の完了の後に影響を受ける 30 秒ウィンドウの数を最小限に抑えるために集計されます。


## <a name="premium-gen2-background-operation-scheduling"></a>Premium Gen2 のバックグラウンド操作のスケジュール設定

更新は、同じ時間にスケジュールされている他のバックグラウンド操作の数には関係なく、スケジュールされた時間か、またはそれに近い時間に Premium Gen2 容量で実行されます。 更新されるデータセットやデータフローは、それらを読み込むために使用できる十分なメモリを備えた物理処理ノードに配置された後、更新プロセスを開始します。 

更新の処理中に、データセットでは、その更新プロセスを完了するためにより多くのメモリが消費される可能性があります。 更新エンジンによって、どの成果物も、その基本 SKU で消費することが許可されているメモリの量 (たとえば、P1 サブスクリプションでは 25 GB、P2 サブスクリプションでは 50 GB など) を超えることはできなくなります。
    
## <a name="how-autoscale-works-in-premium-gen2"></a>Premium Gen2 での自動スケーリングのしくみ

Premium Gen2 では、使用率レコードを 30 秒ごとに集計することによって使用率を評価します。 各評価は、次の 2 種類の集計で構成されます。 
* 対話的な使用率
* バックグラウンド使用率

**対話的な使用率** は、現在の 30 秒の評価サイクルか、またはほぼその評価サイクルで完了したすべての対話型の操作を考慮することによって評価されます。

**バックグラウンド使用率** は、過去 24 時間以内に完了したすべてのバックグラウンド操作を考慮することによって評価されます。 各バックグラウンド操作は、その合計 CPU コストの 1/2880 にのみ寄与します (2880 は 24 時間の期間内の評価サイクルの数です)。

各容量は、等しい数のフロントエンドおよびバックエンド仮想コアで構成されます。 使用率レコードで測定された CPU 時間にはバックエンド仮想コアの使用率が反映されており、その使用率によって自動スケーリングのニーズが促進されます。 フロントエンド仮想コアの使用率は追跡され"*ない*" ため、フロントエンド仮想コアをバックエンド仮想コアに変換することはできません。

4 つのバックエンド仮想コアを含む P1 サブスクリプションがある場合、各評価サイクル クォータは (4*30 = 120 秒) の CPU 使用率に相当します。 対話的な使用率とバックグラウンド使用率の両方の合計が容量内の合計のバックエンド仮想コア クォータを超えると、今後 24 時間、容量は 1 つの仮想コアで自動スケーリングされます。

自動スケーリングでは、使用している量を評価するために、常に現在の容量サイズを考慮するため、既に 1 つの仮想コアに自動スケーリングしている場合、その仮想コアはフロントエンド使用率の 50% とバックエンド使用率の 50% に均等に分散されます。 つまり、最大容量は現在、1 つの評価サイクルで (120 + 0.5 * 30 = 135 秒) の CPU 時間になっています。

自動スケーリングでは常に、1 つの対話型の操作ですべての容量を使用できないように保証するため、自動スケーリングを開始するには、1 つの評価サイクルで 2 つ以上の操作が実行されるようにする必要があります。


## <a name="implications-for-not-using-autoscale-in-premium-gen2"></a>Premium Gen2 で自動スケーリングを使用しないことの影響

容量の使用率がそのリソースの 100% を超えたが、自動スケーリングが無効になっているか、または既にその最大の仮想コアの値に達しているために自動スケーリングを開始できない場合、その容量は一時的な "*対話型の要求遅延*" モードになります。 "*対話型の要求遅延*" モードの間、対話型の各要求 (レポートの読み込みや、ビジュアルの相互作用など) は、実行のためにエンジンに送信される前に遅延されます。 

遅延の量は、次のように、検出されたオーバーロードの量に比例します。
* 100% のオーバーロードでは 20 秒の遅延が発生する
* 10% 未満のオーバーロードは無視される

以前の評価が 100% を超えるリソース使用率に評価されている場合、その容量は "*対話型の要求遅延*" モードのままになります。


## <a name="next-steps"></a>次のステップ

* [Power BI Premium とは何ですか?](service-premium-what-is.md)
* [Power BI Premium で自動スケーリングを使用する](service-premium-auto-scale.md)
* [Power BI Premium のよく寄せられる質問](service-premium-faq.md)
* [Power BI Premium Per User に関する FAQ (プレビュー)](service-premium-per-user-faq.md)
* [Azure サブスクリプション管理者を追加または変更する](/azure/cost-management-billing/manage/add-change-subscription-administrator)

他にわからないことがある場合は、 [Power BI コミュニティで質問してみてください](https://community.powerbi.com/)。
